{"version":3,"file":"iterator.js","sources":["../../../../../node_modules/object-scan/lib/generic/iterator.js"],"sourcesContent":["\"use strict\";\n\nconst iterate = (tree, cb) => {\n  const stack = [tree];\n  const parent = [null];\n  const count = [];\n  const depth = [];\n  const path = [];\n  let idx = 0;\n  let inc = true;\n\n  while (idx !== -1) {\n    const e = stack[idx];\n\n    if (e instanceof Set) {\n      stack[idx] = [...e];\n      stack[idx].or = true;\n    } else if (Array.isArray(e)) {\n      if (e.or !== true) {\n        stack.splice(idx, 1, ...e);\n        parent.splice(idx, 1, ...new Array(e.length).fill(parent[idx]));\n\n        if (parent[idx] !== null) {\n          depth[parent[idx]] += e.length - 1;\n        }\n      } else {\n        if (count[idx] === undefined) {\n          count[idx] = 0;\n          depth[idx] = 0;\n        } else if (depth[idx] !== 0) {\n          stack.splice(idx + 1, depth[idx]);\n          parent.splice(idx + 1, depth[idx]);\n          depth[idx] = 0;\n        }\n\n        if (count[idx] < e.length) {\n          stack.splice(idx + 1, 0, e[count[idx]]);\n          parent.splice(idx + 1, 0, idx);\n          count[idx] = (count[idx] || 0) + 1;\n          depth[idx] += 1;\n          inc = true;\n          idx += 1;\n        } else {\n          count[idx] = 0;\n          idx -= 1;\n        }\n      }\n    } else if (inc === true) {\n      path.push(e);\n      cb('ADD', e);\n\n      if (idx === stack.length - 1) {\n        cb('FIN', path);\n        inc = false;\n      } else {\n        idx += 1;\n      }\n    } else {\n      cb('RM', path.pop());\n      idx -= 1;\n    }\n  }\n};\n\nmodule.exports.iterate = iterate;"],"names":[],"mappings":"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"}