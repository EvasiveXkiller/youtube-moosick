{"version":3,"file":"call.js","sources":["../../../../../node_modules/@jsdevtools/readdir-enhanced/lib/call.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.callOnce = exports.safeCall = void 0;\n/**\n * Calls a function with the given arguments, and ensures that the error-first callback is _always_\n * invoked exactly once, even if the function throws an error.\n *\n * @param fn - The function to invoke\n * @param args - The arguments to pass to the function. The final argument must be a callback function.\n *\n * @internal\n */\nfunction safeCall(fn, input, callback) {\n    // Replace the callback function with a wrapper that ensures it will only be called once\n    callback = callOnce(callback);\n    try {\n        fn(input, callback);\n    }\n    catch (err) {\n        callback(err, undefined);\n    }\n}\nexports.safeCall = safeCall;\n/**\n * Returns a wrapper function that ensures the given callback function is only called once.\n * Subsequent calls are ignored, unless the first argument is an Error, in which case the\n * error is thrown.\n *\n * @param callback - The function that should only be called once\n *\n * @internal\n */\nfunction callOnce(callback) {\n    let fulfilled = false;\n    return function onceWrapper(err, result) {\n        if (!fulfilled) {\n            fulfilled = true;\n            callback.call(this, err, result);\n        }\n        else if (err) {\n            // The callback has already been called, but now an error has occurred\n            // (most likely inside the callback function). So re-throw the error,\n            // so it gets handled further up the call stack\n            throw err;\n        }\n    };\n}\nexports.callOnce = callOnce;\n//# sourceMappingURL=call.js.map"],"names":[],"mappings":";;;AACA,MAAM,CAAC,cAAc,CAAC,IAAO,EAAE,YAAY,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;aAC9C,gBAAmB,GAAG,KAAK,EAAE;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,QAAQ,CAAC,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE;AACvC;AACA,IAAI,QAAQ,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC;AAClC,IAAI,IAAI;AACR,QAAQ,EAAE,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;AAC5B,KAAK;AACL,IAAI,OAAO,GAAG,EAAE;AAChB,QAAQ,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC;AACjC,KAAK;AACL,CAAC;aACe,GAAG,SAAS;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,QAAQ,CAAC,QAAQ,EAAE;AAC5B,IAAI,IAAI,SAAS,GAAG,KAAK,CAAC;AAC1B,IAAI,OAAO,SAAS,WAAW,CAAC,GAAG,EAAE,MAAM,EAAE;AAC7C,QAAQ,IAAI,CAAC,SAAS,EAAE;AACxB,YAAY,SAAS,GAAG,IAAI,CAAC;AAC7B,YAAY,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,EAAE,MAAM,CAAC,CAAC;AAC7C,SAAS;AACT,aAAa,IAAI,GAAG,EAAE;AACtB;AACA;AACA;AACA,YAAY,MAAM,GAAG,CAAC;AACtB,SAAS;AACT,KAAK,CAAC;AACN,CAAC;aACe,GAAG,QAAQ"}